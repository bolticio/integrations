{
    "parameters": [
        {
            "meta": {
                "validation": {
                    "required": true,
                    "requiredDetail": {
                        "errorMsg": "Subscription ID is required."
                    }
                },
                "description": "Paddle ID of the subscription entity to work with.",
                "displayName": "Subscription ID",
                "displayType": "text",
                "placeholder": "sub_01hv6y1jedq4p1n0yqn5ba3ky4"
            },
            "name": "subscription_id"
        },
        {
            "meta": {
                "options": [
                    {
                        "label": "Immediately",
                        "value": "immediately"
                    },
                    {
                        "label": "Next Billing Period",
                        "value": "next_billing_period"
                    }
                ],
                "htmlProps": {
                    "allowDynamic": true
                },
                "validation": {
                    "required": true
                },
                "description": "When one-time charges should be billed.",
                "displayName": "Effective From",
                "displayType": "select",
                "placeholder": "Select when to bill charges"
            },
            "name": "effective_from"
        },
        {
            "meta": {
                "children": [
                    {
                        "meta": {
                            "validation": {
                                "required": true
                            },
                            "description": "Paddle ID of an existing catalog price to bill for.",
                            "displayName": "Price ID",
                            "displayType": "text",
                            "placeholder": "pri_01gsz98e27ak2tyhexptwc58yk"
                        },
                        "name": "price_id"
                    },
                    {
                        "meta": {
                            "validation": {
                                "min": 1,
                                "required": true
                            },
                            "description": "Quantity to bill for.",
                            "displayName": "Quantity",
                            "displayType": "number",
                            "placeholder": "1"
                        },
                        "name": "quantity"
                    }
                ],
                "htmlProps": {
                    "allowAdd": true
                },
                "validation": {
                    "required": true
                },
                "description": "List of one-time charges to bill for. Only prices where the billing_cycle is null may be added. You can charge for items that you've added to your catalog by passing the Paddle ID of an existing price entity, or you can charge for non-catalog items by passing a price object.",
                "displayName": "Items",
                "displayType": "array"
            },
            "name": "items"
        },
        {
            "meta": {
                "options": [
                    {
                        "label": "Prevent Change",
                        "value": "prevent_change"
                    },
                    {
                        "label": "Apply Change",
                        "value": "apply_change"
                    }
                ],
                "htmlProps": {
                    "allowDynamic": true
                },
                "validation": {
                    "required": false
                },
                "description": "How Paddle should handle changes if the payment fails during the one-time charge preview. If omitted, defaults to prevent_change.",
                "displayName": "On Payment Failure",
                "displayType": "select",
                "placeholder": "Select behavior"
            },
            "name": "on_payment_failure"
        }
    ],
    "definition": {
        "url": "https://{{secrets.environment_url}}/subscriptions/{{parameters.subscription_id}}/charge/preview",
        "body": {
            "items": "{{parameters.items}}",
            "effective_from": "{{parameters.effective_from}}",
            "on_payment_failure": "{{parameters.on_payment_failure}}"
        },
        "method": "post",
        "headers": {
            "Accept": "application/json",
            "Content-Type": "application/json",
            "Authorization": "Bearer {{secrets.api_key}}"
        },
        "response": {
            "error": {
                "code": "{{response.status}}",
                "message": "{{response.data}}"
            },
            "output": "{{response.data.data}}"
        }
    }
}
