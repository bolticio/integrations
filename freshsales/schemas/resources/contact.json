{
    "parameters": [
        {
            "meta": {
                "validation": {
                    "required": true
                },
                "description": "Enter the Contact ID of the account you want fetch.",
                "displayName": "Contact ID",
                "displayType": "text",
                "placeholder": "Enter the Contact ID"
            },
            "name": "id"
        }
    ],
    "getContactViews": {
        "definition": {
            "qs": {},
            "url": "{{secrets.api_url}}/api/contacts/filters",
            "method": "get",
            "headers": {
                "Authorization": "Token token={{secrets.api_key}}"
            },
            "response": {
                "error": {
                    "code": "{{response.data.errors.code}}",
                    "message": "{{response.data.errors.message}}"
                },
                "output": "{{response.data.filters}}"
            }
        }
    },
    "getMoreParameters": {
        "definition": {
            "qs": {},
            "url": "{{secrets.api_url}}/api/settings/contacts/fields",
            "method": "get",
            "headers": {
                "Authorization": "Token token={{secrets.api_key}}"
            },
            "response": {
                "error": {
                    "code": "{{response.data.errors.code}}",
                    "message": "{{response.data.errors.message}}"
                },
                "output": "{{response.data.fields}}"
            },
            "transform": {
                "output": "const result = output.sort((a, b) => a.position - b.position).map((ele) => { const excludeParameters = [ 'phone_numbers', 'sales_accounts', 'active_sales_sequences', 'last_contacted', 'last_contacted_mode', 'last_contacted_sales_activity_mode', 'last_contacted_via_sales_activity', 'completed_sales_sequences', 'last_seen', 'lead_score', 'recent_note', 'creater_id', 'created_at', 'updater_id', 'updated_at', 'web_form_ids', 'last_assigned_at', ]; if (!excludeParameters.includes(ele.name)) { const typeMap = { text: 'text', textarea: 'textarea', dropdown: 'select', auto_complete: 'multitext', multi_select_dropdown: 'multiselect', radio: 'select', number: 'number', }; const placeholderPrefix = ['select', 'multiselect', 'radio'].includes( typeMap[ele.type] ) ? 'Select' : 'Enter'; const requiredParameters = ['emails', 'first_name']; const newObj = { name: ele.name, meta: { displayName: ele.label, displayType: typeMap[ele.type] || 'text', placeholder: `${placeholderPrefix} ${ele.label}`, validation: { required: requiredParameters.includes(ele.name) || ele.required, }, }, }; if (['dropdown', 'radio', 'multi_select_dropdown'].includes(ele.type)) { newObj.meta.htmlProps = { allowDynamic: true }; if (ele.choices && ele.choices.length) { newObj.meta.options = ele.choices.map((choice) => ({ label: choice.value, value: choice.id, })); } else { newObj.meta.displayType = 'text'; } if (ele.type === 'multi_select_dropdown') { newObj.meta.value = []; } } if (ele.default === false) { newObj.prop = 'custom_field'; } return newObj; } return null; }).filter((ele) => ele !== null); let custom_field = { name: 'custom_field', meta: { children: [], displayType: 'object', }, }; const outputWithCustomField = result.reduce((acc, ele) => { if (ele.prop === 'custom_field') { custom_field.meta.children.push(ele); } else { acc.push(ele); } return acc; }, []); if (custom_field.meta.children.length > 0) { outputWithCustomField.push(custom_field); } return outputWithCustomField"
            }
        }
    },
    "definition": {
        "qs": {
            "include": "sales_accounts"
        },
        "url": "{{secrets.api_url}}/api/contacts/{{parameters.id}}",
        "body": {},
        "method": "get",
        "headers": {
            "Content-Type": "application/json",
            "Authorization": "Token token={{secrets.api_key}}"
        },
        "response": {
            "error": {
                "code": "{{response.data.errors.code}}",
                "message": "{{response.data.errors.message}}"
            },
            "output": "{{response.data.contact}}"
        }
    },
    "config": {
        "url": "integrations/parameters",
        "body": {
            "name": "freshsales",
            "secret": "{{parameters.secret}}",
            "resource": "contact",
            "loadParametersMethod": "getMoreParameters"
        },
        "method": "post",
        "urlType": "parameters"
    }
}
